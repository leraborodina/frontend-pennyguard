<div class="container">
  <div class="filter-container">
    <mat-form-field class="filter-field">
      <input matInput placeholder="Search ..." [formControl]="searchControl" (input)="applyFilters()">
    </mat-form-field>

    <mat-form-field class="filter-field">
      <mat-label>Category</mat-label>
      <mat-select [formControl]="categoriesControl" (selectionChange)="applyFilters()">
        <mat-option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field class="filter-field">
      <mat-label>Transaction Type</mat-label>
      <mat-select [formControl]="transactionTypeControl" (selectionChange)="applyFilters()">
        <mat-option *ngFor="let transactionType of transactionTypes" [value]="transactionType.id">{{
          transactionType.type }}</mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field class="filter-field">
      <input matInput type="number" min="0" placeholder="Min Amount" [formControl]="minAmountControl"
        (input)="applyFilters()">
    </mat-form-field>

    <mat-form-field class="filter-field">
      <input matInput type="number" min="0" placeholder="Max Amount" [formControl]="maxAmountControl"
        (input)="applyFilters()">
    </mat-form-field>

    <mat-form-field class="filter-field">
      <input matInput [matDatepicker]="picker" placeholder="Transaction Date" [formControl]="maxDateControl"
        (dateChange)="applyFilters()" [max]="maxDateControl">
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>
  </div>

  <div fxLayout="column" fxLayoutAlign="center center" class="transaction-container">
    <mat-card>
      <mat-card-header class="transaction-label">Transactions</mat-card-header>
      <mat-card-content>
        <div class="transaction-quantity">
          <span>Total Transactions: {{ filteredTransactions.length }}</span>
        </div>
        <form *ngIf="filteredTransactions.length > 0">
          <table class="table">
            <thead>
              <tr>
                <th>Date</th>
                <th>Category</th>
                <th>Purpose</th>
                <th>Amount</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let transaction of transactions; let i = index" class="transaction-item">
                <td>{{ transaction.createdAt }}</td>
                <td>{{ transaction.categoryId || 'N/A' }}</td>
                <td>{{ transaction.purpose || 'N/A' }}</td>
                <td [style.color]="getAmountColorByTransactionType(transaction.typeId)">
                  {{ getAmountWithSignAndColor(transaction.amount, transaction.typeId) || 'N/A' }}
                </td>
                <td>
                  <div class="action-buttons">
                    <button mat-icon-button color="primary" type="button" (click)="deleteTransaction(transaction.id)">
                      <mat-icon>delete</mat-icon>
                    </button>
                    <button mat-icon-button color="primary" type="button" (click)="editTransaction(transaction.id)">
                      <mat-icon>edit</mat-icon>
                    </button>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </form>
        <div *ngIf="filteredTransactions.length === 0" class="empty-list-message">
          No transactions available.
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>